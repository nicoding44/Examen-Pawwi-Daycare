<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Pawwi Academy</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function(){ emailjs.init("lqOGtKO0YTxycmgYU"); })();
    </script>
    
    <style>
        /* --- üé® PAWWI DESIGN SYSTEM 2.0 --- */
        :root {
            /* Colores Principales */
            --primary: #6B46C1;
            --primary-gradient: linear-gradient(135deg, #6B46C1 0%, #805AD5 100%);
            --secondary: #ED64A6;
            --secondary-gradient: linear-gradient(135deg, #ED64A6 0%, #F687B3 100%);
            
            /* Fondos y Superficies */
            --bg-body: #F7FAFC; /* Gris muy suave para contraste */
            --bg-card: #FFFFFF;
            
            /* Texto */
            --text-dark: #2D3748;
            --text-gray: #718096;
            
            /* Estados */
            --success: #38A169;
            --success-light: #F0FFF4;
            --error: #E53E3E;
            --error-light: #FFF5F5;
            
            /* UI Elements */
            --radius-box: 20px;
            --radius-btn: 14px;
            --shadow-soft: 0 10px 30px -5px rgba(107, 70, 193, 0.15);
            --shadow-card: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-dark);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            /* Header Decorativo Superior */
            background-image: radial-gradient(circle at 50% -20%, #E9D8FD 0%, transparent 60%);
            background-repeat: no-repeat;
            background-size: 100% 400px;
        }

        /* --- TIPOGRAF√çA --- */
        h1, h2, h3 { font-family: 'Poppins', sans-serif; margin: 0; }
        h1 { font-weight: 800; color: var(--primary); letter-spacing: -0.5px; line-height: 1.1; }
        h2 { font-weight: 700; color: var(--text-dark); font-size: 1.4rem; }
        p { color: var(--text-gray); line-height: 1.6; margin-top: 8px; font-size: 0.95rem; }

        /* --- CONTENEDOR PRINCIPAL --- */
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px 24px 100px 24px; /* Padding bottom extra para botones flotantes */
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* --- COMPONENTES UI --- */
        
        /* 1. Header de Marca */
        .pawwi-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 0;
            margin-bottom: 20px;
        }
        .pawwi-logo { font-family: 'Poppins', sans-serif; font-weight: 800; font-size: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 8px; }
        .pawwi-badge { background: #E9D8FD; color: var(--primary); padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 700; letter-spacing: 0.5px; }

        /* 2. Inputs Modernos */
        .input-group { margin-bottom: 16px; text-align: left; }
        .input-label { display: block; font-size: 0.85rem; font-weight: 600; color: var(--text-dark); margin-bottom: 6px; margin-left: 4px; }
        .modern-input {
            width: 100%;
            padding: 16px;
            border: 2px solid #E2E8F0;
            border-radius: var(--radius-btn);
            background: #fff;
            font-size: 16px;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .modern-input:focus { border-color: var(--primary); box-shadow: 0 0 0 4px rgba(107, 70, 193, 0.1); outline: none; }

        /* 3. Botones "Juicy" */
        .btn-primary {
            width: 100%;
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 18px;
            border-radius: var(--radius-btn);
            font-size: 1rem;
            font-weight: 700;
            font-family: 'Poppins', sans-serif;
            cursor: pointer;
            box-shadow: 0 10px 20px -5px rgba(107, 70, 193, 0.4);
            transition: transform 0.1s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        .btn-primary:active { transform: scale(0.96); }
        .btn-secondary {
            background: transparent;
            color: var(--text-gray);
            border: 2px solid #E2E8F0;
            padding: 14px;
            border-radius: var(--radius-btn);
            font-weight: 600;
            width: 100%;
            cursor: pointer;
        }

        /* 4. Tarjetas de M√≥dulos (Playlist) */
        .module-list { display: flex; flex-direction: column; gap: 12px; }
        .module-card {
            background: var(--bg-card);
            padding: 16px;
            border-radius: var(--radius-box);
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow-card);
            border: 1px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        .module-card:active { transform: scale(0.98); background: #FAF5FF; }
        .module-card.locked { opacity: 0.6; background: #F7FAFC; box-shadow: none; border: 1px solid #EDF2F7; }
        .module-card.watched { border: 1px solid var(--success); background: var(--success-light); }
        .module-card.watched h3 { color: var(--success); }

        .play-icon {
            width: 40px; height: 40px;
            background: #F3EAFE;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            color: var(--primary);
            flex-shrink: 0;
            margin-right: 15px;
            font-size: 1.2rem;
        }
        .module-card.watched .play-icon { background: var(--success); color: white; }

        /* 5. Video Player */
        .video-container {
            background: black;
            border-radius: var(--radius-box);
            overflow: hidden;
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.3);
            margin: 20px 0;
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
        }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }

        /* 6. Quiz Gamificado */
        .progress-container { margin-bottom: 25px; }
        .progress-label { display: flex; justify-content: space-between; font-size: 0.8rem; font-weight: 700; color: var(--text-gray); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; }
        .progress-bar-bg { background: #EDF2F7; height: 12px; border-radius: 10px; overflow: hidden; }
        .progress-bar-fill { background: var(--secondary-gradient); height: 100%; width: 0%; border-radius: 10px; transition: width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); }

        .quiz-option {
            background: white;
            padding: 20px;
            border-radius: var(--radius-box);
            border: 2px solid transparent;
            box-shadow: var(--shadow-card);
            margin-bottom: 12px;
            font-weight: 500;
            font-size: 1rem;
            text-align: left;
            width: 100%;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        .quiz-option:active { transform: scale(0.98); }
        
        /* Estados de respuesta */
        .quiz-option.correct { background: var(--success-light); border-color: var(--success); color: var(--success); font-weight: 700; }
        .quiz-option.incorrect { background: var(--error-light); border-color: var(--error); color: var(--error); }
        .quiz-option.correct::after { content: "‚úÖ"; position: absolute; right: 20px; }
        .quiz-option.incorrect::after { content: "‚ùå"; position: absolute; right: 20px; }

        .feedback-box {
            background: white;
            padding: 20px;
            border-radius: var(--radius-box);
            margin-top: 20px;
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.1);
            border-left: 6px solid var(--primary);
            animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* Utilidades */
        .hidden { display: none !important; }
        .sticky-bottom { position: fixed; bottom: 0; left: 0; width: 100%; padding: 20px; background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); z-index: 100; border-top: 1px solid rgba(0,0,0,0.05); }
        .fade-in { animation: fadeIn 0.4s ease-in; }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        /* Spinner */
        .loader { width: 48px; height: 48px; border: 5px solid #FFF; border-bottom-color: var(--primary); border-radius: 50%; display: inline-block; box-sizing: border-box; animation: rotation 1s linear infinite; }
        @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    </style>
</head>
<body>

    <div class="container fade-in">
        
        <div class="pawwi-header">
            <div class="pawwi-logo">
                <span style="font-size: 1.2em;">üê∂</span> Pawwi
            </div>
            <div class="pawwi-badge">ACADEMY</div>
        </div>

        <div id="screen-login">
            <div style="margin: 30px 0 40px 0;">
                <h1 style="font-size: 2.5rem; margin-bottom: 10px;">¬°Hola<br><span style="color: var(--secondary);">Pawwer!</span></h1>
                <p>Tu camino para convertirte en un experto en cuidado canino comienza aqu√≠.</p>
            </div>
            
            <div class="input-group">
                <label class="input-label">Nombre Completo</label>
                <input type="text" id="user-name" class="modern-input" placeholder="Ej: Pepito P√©rez">
            </div>
            <div class="input-group">
                <label class="input-label">C√©dula / ID</label>
                <input type="number" id="user-cedula" class="modern-input" placeholder="Ej: 123456789" inputmode="numeric">
            </div>
            <div class="input-group">
                <label class="input-label">Correo Electr√≥nico</label>
                <input type="email" id="user-email" class="modern-input" placeholder="ejemplo@pawwi.com">
            </div>
            <div class="input-group">
                <label class="input-label">Celular</label>
                <input type="tel" id="user-phone" class="modern-input" placeholder="300 123 4567" inputmode="tel">
            </div>
            
            <button class="btn-primary" onclick="app.login()" style="margin-top: 20px;">
                Comenzar Entrenamiento üöÄ
            </button>
        </div>

        <div id="screen-dashboard" class="hidden">
            <div style="margin-bottom: 25px;">
                <h2>M√≥dulos de Video</h2>
                <p>Completa cada lecci√≥n para desbloquear el examen final.</p>
            </div>

            <div id="modules-container" class="module-list">
                </div>

            <div class="sticky-bottom fade-in">
                <button class="btn-primary" onclick="app.goToQuiz()">
                    Presentar Examen Final üìù
                </button>
            </div>
        </div>

        <div id="screen-player" class="hidden">
            <button class="btn-secondary" onclick="app.showDashboard()" style="margin-bottom: 20px; width: auto; padding: 10px 20px; font-size: 0.9rem;">
                ‚Üê Volver
            </button>
            
            <h2 id="player-title" style="margin-bottom: 15px; font-size: 1.2rem;">T√≠tulo del Video</h2>
            
            <div class="video-container">
                <div id="player-iframe-container"></div>
            </div>
            
            <div style="background: #F0FFF4; padding: 15px; border-radius: 12px; margin-top: 20px; display: flex; gap: 10px;">
                <span>üí°</span>
                <small style="color: #276749; font-weight: 500;">Tip: Gira tu celular para ver en pantalla completa.</small>
            </div>

            <div class="sticky-bottom fade-in">
                <button class="btn-primary" onclick="app.markAsWatched()">
                    ‚úÖ ¬°Listo! Lecci√≥n aprendida
                </button>
            </div>
        </div>

        <div id="screen-quiz" class="hidden">
            <div class="progress-container">
                <div class="progress-label">
                    <span>Progreso</span>
                    <span><span id="q-current">1</span>/<span id="q-total">30</span></span>
                </div>
                <div class="progress-bar-bg">
                    <div class="progress-bar-fill" id="progress"></div>
                </div>
            </div>
            
            <h2 id="question-text" style="font-size: 1.3rem; margin-bottom: 30px; min-height: 80px;">Pregunta...</h2>
            
            <div id="options-container"></div>
            
            <div id="feedback-container" class="feedback-box hidden"></div>
            
            <div style="height: 100px;"></div> 

            <div class="sticky-bottom hidden" id="sticky-next-btn">
                <button class="btn-primary" onclick="app.nextQuestion()">
                    Siguiente Pregunta ‚Üí
                </button>
            </div>
        </div>

        <div id="screen-loading" class="hidden" style="text-align: center; margin-top: 100px;">
            <span class="loader"></span>
            <h2 style="color: var(--primary); margin-top: 20px;">Analizando respuestas...</h2>
            <p>Conectando con la central de Pawwi.</p>
        </div>

        <div id="screen-result" class="hidden" style="text-align: center;">
            <div style="font-size: 80px; margin: 30px 0; animation: slideUp 0.5s;">
                <span id="result-icon"></span>
            </div>
            
            <h1 id="result-title" style="margin-bottom: 10px;"></h1>
            <p id="result-message" style="font-size: 1.1rem; color: var(--text-dark); max-width: 300px; margin: 0 auto;"></p>
            
            <div style="background: white; padding: 30px; border-radius: 24px; margin: 40px 0; box-shadow: var(--shadow-soft);">
                <small style="text-transform: uppercase; color: var(--text-gray); font-weight: 700; letter-spacing: 1px;">Tu Puntaje</small>
                <div style="display: flex; justify-content: center; align-items: baseline; gap: 5px; margin-top: 10px;">
                    <span id="final-score" style="font-size: 4rem; font-weight: 800; color: var(--primary); line-height: 1;">0</span>
                    <span style="font-size: 1.5rem; color: var(--text-gray); font-weight: 600;">/30</span>
                </div>
            </div>

            <button class="btn-secondary" onclick="location.reload()">
                Volver al Inicio
            </button>
        </div>

    </div>

    <script>
        /* --- üß† PAWWI BRAIN --- */
        const CONFIG = {
            EMAIL_SERVICE_ID: "service_hsecs6f",
            EMAIL_TEMPLATE_ID: "template_q0nxumd"
        };

        const MODULES = [
            { id: 1, title: "Bienvenida Pawwi", url: "https://youtube.com/shorts/ZNHrozxD3gc?si=ik-ofwVsyPDBIkxM", duration: "1 min" },
            { id: 2, title: "Playbook Daycare", url: "https://youtube.com/shorts/ZDCJtDrHxoc?si=SG48dLG-iTH5vt-Y", duration: "1 min" },
            { id: 3, title: "Flujo Operativo", url: "https://youtube.com/shorts/cOCOE-5M88k?si=_sY2yXQqjRypnIqV", duration: "1 min" },
            { id: 4, title: "Adaptar el Hogar", url: "https://youtube.com/shorts/5vbilzjl96U?si=pEZAxHG4pGi3IvOf", duration: "1 min" },
            { id: 5, title: "Comportamiento Canino", url: "https://youtu.be/h0_NBxeerB0?si=PYZ2i7eum-z-c3ZM", duration: "Masterclass" },
            { id: 6, title: "Gu√≠a de Emergencias", url: "https://youtu.be/8dCHJOpEx_c?si=aDvU3o_C2ibeCAyW", duration: "Vital" },
            { id: 7, title: "Aspectos Legales 1", url: "https://youtu.be/5AP7ewYdWMU", duration: "Importante" }, 
            { id: 8, title: "Aspectos Legales 2", url: "https://youtu.be/xvbWRHk5BYo", duration: "Importante" }
        ];

        const QUESTIONS = [
            { q: "¬øCu√°l es la diferencia fundamental entre Pawwi y una guarder√≠a tradicional?", options: ["Manadas grandes", "Experiencia 100% hogar sin jaulas", "Perros solos", "Solo paseos"], correct: 1, rationale: "Somos hogar y libertad." },
            { q: "Al ingresar un perro, lo PRIMERO es:", options: ["Dar comida", "Grabar video de estado", "Pasear", "Esperar instrucciones"], correct: 1, rationale: "El video de ingreso es tu seguro." },
            { q: "¬øQu√© haces ante una emergencia personal grave?", options: ["Salir r√°pido", "Dejarlo con vecino", "Llevarlo en moto", "Notificar y NO abandonar"], correct: 3, rationale: "Nunca abandonamos la custodia." },
            { q: "Condici√≥n INDISPENSABLE del hogar:", options: ["Patio con pasto", "Prevenci√≥n total de fugas", "Juguetes propios", "C√°maras"], correct: 1, rationale: "Seguridad ante todo: mallas y cerramientos." },
            { q: "Ante herida profunda o cojera:", options: ["Esperar", "Remedio casero", "Soporte + Vet autorizado", "Llamar due√±o primero"], correct: 2, rationale: "Primero la salud, coordina Pawwi." },
            { q: "¬øQu√© cubre el Fondo de Asistencia?", options: ["Muebles", "Integridad f√≠sica del perro", "Objetos perdidos", "Enfermedades viejas"], correct: 1, rationale: "Protegemos la vida del perro." },
            { q: "Consecuencia de un 'No Show':", options: ["Leve", "Multa", "Terminaci√≥n inmediata", "Nada"], correct: 2, rationale: "La confianza es nuestro pilar." },
            { q: "¬øActualizaciones obligatorias?", options: ["Una", "Cada 10min", "Inicio, Intermedia, Final", "Ninguna"], correct: 2, rationale: "Trazabilidad completa." },
            { q: "Si hay agresividad:", options: ["Gritar", "Aislar con calma y reportar", "Sacarlo", "Juntar con otro"], correct: 1, rationale: "Calma y seguridad." },
            { q: "¬øCu√°ndo paga Pawwi?", options: ["Efectivo", "Mensual", "Viernes", "Nequi directo"], correct: 2, rationale: "Cortes semanales." },
            { q: "Tiempo para reprogramar sin multa:", options: ["Cuando quiera", "8 horas antes", "1 hora", "Despu√©s"], correct: 1, rationale: "Log√≠stica responsable." },
            { q: "¬øVisitas durante el servicio?", options: ["Familia", "No, prohibido", "Si ayudan", "Amigos"], correct: 1, rationale: "Cero extra√±os con los perros." },
            { q: "Costo transporte (trayecto):", options: ["$5.000", "$10.000", "Gratis", "$2.000"], correct: 0, rationale: "Tarifa est√°ndar." },
            { q: "¬øCorrea en parques?", options: ["A veces", "SIEMPRE", "Nunca", "Si es noble"], correct: 1, rationale: "Control total siempre." },
            { q: "¬øDar snacks propios?", options: ["Fruta", "No (Alergias)", "Poquito", "Si pide"], correct: 1, rationale: "Solo lo que env√≠e el due√±o." },
            { q: "Si se escapa:", options: ["Esperar", "Soporte INMEDIATO", "Llorar", "Buscar solo"], correct: 1, rationale: "Activar protocolo de b√∫squeda." },
            { q: "C√≥digo intruso:", options: ["'Ayuda'", "Texto clave de seguridad", "Polic√≠a", "Gritar"], correct: 1, rationale: "Confirma estado del perro." },
            { q: "Sismo:", options: ["Abrir", "Asegurar perro y zona segura", "Balc√≥n", "Esconderse"], correct: 1, rationale: "Evitar fuga por p√°nico." },
            { q: "Alergia grave:", options: ["Hambre", "Hinchaz√≥n/Ahogo", "Sue√±o", "Sed"], correct: 1, rationale: "Urgencia veterinaria." },
            { q: "Visita aleatoria rechazada:", options: ["Reprograma", "Suspensi√≥n (Transparencia)", "Multa", "Nada"], correct: 1, rationale: "Debemos poder auditar." },
            { q: "Docs Fondo Asistencia:", options: ["Solo palabra", "Evidencia + Factura + Historia", "Foto", "Nada"], correct: 1, rationale: "Soporte documental." },
            { q: "Tiempo respuesta Fondo:", options: ["24h", "5 d√≠as", "1 mes", "Ya"], correct: 0, rationale: "Agilidad." },
            { q: "Evidencia final:", options: ["Video perro + cosas", "Selfie", "Texto", "Nada"], correct: 0, rationale: "Descargo de responsabilidad." },
            { q: "Cables el√©ctricos:", options: ["Dejar", "Cubrir/Esconder", "Nada", "Desconectar"], correct: 1, rationale: "Riesgo electrocuci√≥n." },
            { q: "Aceptar servicio:", options: ["Llamar", "'Lo tomo'", "Like", "Ir"], correct: 1, rationale: "Orden en el grupo." },
            { q: "Indicadores calidad:", options: ["Marca", "Puntualidad/Amor/Reportes", "TV", "Casa"], correct: 1, rationale: "Servicio 5 estrellas." },
            { q: "Puntualidad recogida:", options: ["Hora exacta", "5 min antes", "Tarde", "30 min"], correct: 0, rationale: "Respeto al tiempo." },
            { q: "Objeto extra√±o ingerido:", options: ["Vomitar", "Identificar + Foto + Vet", "Leche", "Esperar"], correct: 1, rationale: "No adivinar." },
            { q: "Servicio m√≠nimo:", options: ["30min", "1 hora", "4 horas", "1 d√≠a"], correct: 1, rationale: "Operatividad." },
            { q: "Delegar a roomie:", options: ["S√≠", "No, intransferible", "A veces", "Si sabe"], correct: 1, rationale: "T√∫ eres el certificado." }
        ];

        const app = {
            userData: {},
            currentQuestion: 0,
            score: 0,
            currentModuleIndex: null,

            login: function() {
                const i = ['user-name','user-cedula','user-email','user-phone'].map(id => document.getElementById(id).value.trim());
                if(i.some(val => val === "")) return alert("‚úã ¬°Faltan datos por llenar!");
                
                this.userData = { name: i[0], cedula: i[1], email: i[2], phone: i[3] };
                this.switchScreen('screen-login', 'screen-dashboard');
                this.renderModules();
            },

            renderModules: function() {
                const c = document.getElementById('modules-container');
                c.innerHTML = '';
                MODULES.forEach((m, idx) => {
                    const div = document.createElement('div');
                    div.className = `module-card ${m.url ? '' : 'locked'}`;
                    div.innerHTML = `
                        <div style="display:flex; align-items:center;">
                            <div class="play-icon">‚ñ∂</div>
                            <div>
                                <h3 style="font-size:1rem; margin-bottom:4px;">${m.title}</h3>
                                <small style="color:var(--text-gray);">${m.duration}</small>
                            </div>
                        </div>
                    `;
                    if(m.url) div.onclick = () => this.playVideo(idx);
                    c.appendChild(div);
                });
            },

            playVideo: function(idx) {
                this.currentModuleIndex = idx;
                const m = MODULES[idx];
                let id = m.url.split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/|shorts\/)/)[2].split(/[^0-9a-z_-]/i)[0];
                
                document.getElementById('player-title').innerText = m.title;
                document.getElementById('player-iframe-container').innerHTML = 
                    `<iframe src="https://www.youtube.com/embed/${id}?rel=0&modestbranding=1&playsinline=1" allowfullscreen></iframe>`;
                
                this.switchScreen('screen-dashboard', 'screen-player');
            },

            markAsWatched: function() {
                const cards = document.querySelectorAll('.module-card');
                if(cards[this.currentModuleIndex]) cards[this.currentModuleIndex].classList.add('watched');
                this.switchScreen('screen-player', 'screen-dashboard');
                document.getElementById('player-iframe-container').innerHTML = ""; // Stop video
            },

            goToQuiz: function() {
                if(!confirm("‚ö†Ô∏è ¬øViste todos los videos?\n\nEl examen requiere los conocimientos del Playbook.")) return;
                this.switchScreen('screen-dashboard', 'screen-quiz');
                this.loadQuestion();
            },

            loadQuestion: function() {
                const q = QUESTIONS[this.currentQuestion];
                document.getElementById('q-current').innerText = this.currentQuestion + 1;
                document.getElementById('question-text').innerText = q.q;
                
                // Animaci√≥n Barra
                setTimeout(() => {
                    document.getElementById('progress').style.width = ((this.currentQuestion / QUESTIONS.length) * 100) + "%";
                }, 100);

                const c = document.getElementById('options-container');
                c.innerHTML = '';
                document.getElementById('feedback-container').classList.add('hidden');
                document.getElementById('sticky-next-btn').classList.add('hidden');

                q.options.forEach((opt, idx) => {
                    const btn = document.createElement('button');
                    btn.className = 'quiz-option';
                    btn.innerText = opt;
                    btn.onclick = () => this.check(idx, btn);
                    c.appendChild(btn);
                });
            },

            check: function(idx, btn) {
                // Lock buttons
                document.querySelectorAll('.quiz-option').forEach(b => b.disabled = true);
                
                const q = QUESTIONS[this.currentQuestion];
                const feedback = document.getElementById('feedback-container');
                const isCorrect = idx === q.correct;

                btn.classList.add(isCorrect ? 'correct' : 'incorrect');
                if(!isCorrect) document.querySelectorAll('.quiz-option')[q.correct].classList.add('correct');
                
                if(isCorrect) this.score++;

                feedback.innerHTML = `
                    <strong style="color: ${isCorrect ? 'var(--success)' : 'var(--error)'}; font-size: 1.1rem;">
                        ${isCorrect ? '¬°Eso es! üéâ' : 'Ups... üòÖ'}
                    </strong>
                    <p style="margin-top:5px; color: var(--text-dark);">${q.rationale}</p>
                `;
                feedback.classList.remove('hidden');
                feedback.style.borderColor = isCorrect ? 'var(--success)' : 'var(--error)';
                
                document.getElementById('sticky-next-btn').classList.remove('hidden');
            },

            nextQuestion: function() {
                this.currentQuestion++;
                if(this.currentQuestion < QUESTIONS.length) {
                    this.loadQuestion();
                    window.scrollTo(0,0);
                } else {
                    this.finish();
                }
            },

            finish: function() {
                this.switchScreen('screen-quiz', 'screen-loading');
                const passed = this.score >= 24;
                
                emailjs.send(CONFIG.EMAIL_SERVICE_ID, CONFIG.EMAIL_TEMPLATE_ID, {
                    name: this.userData.name,
                    cedula: this.userData.cedula,
                    phone: this.userData.phone,
                    email: this.userData.email,
                    score: this.score,
                    total: QUESTIONS.length,
                    status: passed ? "APROBADO" : "REPROBADO"
                }).then(() => this.showResult(passed), () => {
                    alert("Error de conexi√≥n, toma captura.");
                    this.showResult(passed);
                });
            },

            showResult: function(passed) {
                this.switchScreen('screen-loading', 'screen-result');
                document.getElementById('final-score').innerText = this.score;
                
                const els = {
                    icon: document.getElementById('result-icon'),
                    title: document.getElementById('result-title'),
                    msg: document.getElementById('result-message')
                };

                if(passed) {
                    els.icon.innerText = "üéì";
                    els.title.innerText = "¬°Bienvenido Pawwer!";
                    els.title.style.color = "var(--primary)";
                    els.msg.innerText = "Has superado la certificaci√≥n oficial. El equipo se pondr√° en contacto contigo.";
                } else {
                    els.icon.innerText = "üìö";
                    els.title.innerText = "A repasar un poco";
                    els.title.style.color = "var(--text-dark)";
                    els.msg.innerText = "No te desanimes. Vuelve a ver los videos clave e int√©ntalo de nuevo.";
                }
            },

            switchScreen: function(from, to) {
                document.getElementById(from).classList.add('hidden');
                document.getElementById(to).classList.remove('hidden');
                window.scrollTo(0,0);
            }
        };
    </script>
</body>
</html>
